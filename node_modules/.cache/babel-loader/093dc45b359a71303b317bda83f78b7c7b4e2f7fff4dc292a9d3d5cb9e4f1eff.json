{"ast":null,"code":"import \"core-js/modules/web.dom-exception.stack.js\";\nimport { Terminal } from 'xterm';\nimport { FitAddon } from 'xterm-addon-fit';\nimport 'xterm/css/xterm.css';\nimport { debounce } from 'lodash';\nimport { getCurrentInstance, reactive, onBeforeUnmount, onUnmounted, onMounted, toRefs, ref } from 'vue';\nimport { useRoute } from 'vue-router';\nexport default {\n  setup() {\n    const route = useRoute();\n    const terminal = ref();\n    onBeforeUnmount(() => {\n      removeResizeListener();\n      config.term && config.term.dispose();\n      config.ws.send(JSON.stringify({\n        type: 'stdin',\n        data: utf8_to_b64('exit')\n      }));\n    });\n    onUnmounted(() => {\n      config.ws.send(JSON.stringify({\n        type: 'stdin',\n        data: utf8_to_b64('exit')\n      }));\n    });\n    onMounted(() => {\n      config.source = route.query.source;\n      config.type = route.query.type;\n      config.id = route.query.id;\n      if (config.source === 'plat') {\n        if (config.type === 'vm') {\n          // 调用虚拟机详情接口查询登录信息\n          getVmDetail();\n          submitForm();\n        } else if (config.type === 'host') {\n          // 调用物理机详情接口查询登录信息\n        }\n      }\n    });\n    const {\n      proxy\n    } = getCurrentInstance();\n    const packResize = (cols, rows) => JSON.stringify({\n      type: 'resize',\n      cols: cols,\n      rows: rows\n    });\n    const validate = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('不能为空'));\n      } else {\n        callback();\n      }\n    };\n    const config = reactive({\n      id: 0,\n      source: '',\n      type: '',\n      rules: {\n        ip: [{\n          validator: validate,\n          trigger: 'blur'\n        }],\n        port: [{\n          validator: validate,\n          trigger: 'blur'\n        }],\n        user: [{\n          validator: validate,\n          trigger: 'blur'\n        }],\n        pwd: [{\n          validator: validate,\n          trigger: 'blur'\n        }]\n      },\n      // activeName: 'first',\n      initText: '正在努力连接中...\\r\\n',\n      first: true,\n      term: null,\n      fitAddon: null,\n      ws: null,\n      socketUrl: proxy.$urls.m().ws,\n      formData: {\n        user: 'root',\n        pwd: '',\n        ip: '',\n        port: '22'\n      },\n      option: {\n        lineHeight: 1.0,\n        cursorBlink: true,\n        cursorStyle: 'block',\n        // 光标样式 'block' | 'underline' | 'bar'\n        fontSize: 15,\n        // fontcolor: '#000000',\n        fontFamily: \"Monaco, Menlo, Consolas, 'Courier New', monospace\",\n        theme: {\n          // 背景色\n          background: '#ffffff',\n          // 前景色\n          foreground: '#000000',\n          // 光标背景色\n          cursor: '#000000',\n          // 光标前景色\n          /** The accent color of the cursor (fg color for a block cursor) */\n          // cursorAccent: '#000000',\n          // 选择背景色\n          /** The selection background color (can be transparent) */\n          selection: '#0000ff',\n          // 选择前景色\n          /** The selection foreground color */\n          selectionForeground: '#0000ff'\n        },\n        cols: 30 // 初始化的时候不要设置fit，设置col为较小值（最小为可展示initText初始文字即可）方便屏幕缩放\n      }\n    });\n\n    const initWs = () => {\n      initTerm();\n      initSocket();\n      onTerminalResize();\n      onTerminalKeyPress();\n    };\n    const submitForm = () => {\n      config.activeName = 'second';\n      initWs();\n    };\n    const resetForm = formName => {\n      formName.value.resetFields();\n    };\n    const handleClick = (tab, event) => {\n      if (tab.name === 'second') {\n        // this.init()\n      }\n    };\n    function utf8_to_b64(rawString) {\n      return btoa(unescape(encodeURIComponent(rawString)));\n    }\n    function b64_to_utf8(encodeString) {\n      return decodeURIComponent(escape(atob(encodeString)));\n    }\n    function bytesHuman(bytes, precision) {\n      if (!/^([-+])?|(\\.\\d+)(\\d+(\\.\\d+)?|(\\d+\\.)|Infinity)$/.test(bytes)) {\n        return '-';\n      }\n      if (bytes === 0) return '0';\n      if (typeof precision === 'undefined') precision = 1;\n      const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB', 'BB'];\n      const num = Math.floor(Math.log(bytes) / Math.log(1024));\n      const value = (bytes / Math.pow(1024, Math.floor(num))).toFixed(precision);\n      return `${value} ${units[num]}`;\n    }\n    function isWsOpen() {\n      return config.ws && config.ws.readyState === 1;\n    }\n    const initTerm = () => {\n      config.term = new Terminal(config.option);\n      config.fitAddon = new FitAddon();\n      config.term.loadAddon(config.fitAddon);\n      config.term.open(terminal.value);\n      // config.fitAddon.fit() // 初始化的时候不要使用fit\n      setTimeout(() => {\n        config.fitAddon.fit();\n      }, 500); // 必须延时处理\n    };\n\n    function onTerminalKeyPress() {\n      config.term.onData(data => {\n        isWsOpen() && config.ws.send(JSON.stringify({\n          type: 'stdin',\n          data: utf8_to_b64(data)\n        }));\n      });\n    }\n    function resizeRemoteTerminal() {\n      const {\n        cols,\n        rows\n      } = config.term;\n      console.log('列数、行数设置为：', cols, rows);\n      // 调整后端终端大小 使后端与前端终端大小一致\n      isWsOpen() && config.ws.send(packResize(cols, rows));\n    }\n    const onResize = debounce(function () {\n      config.fitAddon.fit();\n    }, 500);\n    function onTerminalResize() {\n      window.addEventListener('resize', onResize);\n      config.term.onResize(resizeRemoteTerminal);\n    }\n    function removeResizeListener() {\n      window.removeEventListener('resize', onResize);\n    }\n    const initSocket = () => {\n      config.term.write(config.initText);\n      console.log(config.socketUrl);\n      config.ws = new WebSocket(config.socketUrl, ['webssh']);\n      onOpenSocket();\n      onCloseSocket();\n      onErrorSocket();\n      config.term._initialized = true;\n      onMessageSocket();\n    };\n    const onOpenSocket = () => {\n      config.ws.onopen = () => {\n        console.log('websocket 已连接');\n        config.ws.send(JSON.stringify({\n          type: \"addr\",\n          data: utf8_to_b64(config.formData.ip + ':' + config.formData.port)\n        }));\n        // socket.send(JSON.stringify({ type: \"term\", data: utf8_to_b64(\"linux\") }));\n        config.ws.send(JSON.stringify({\n          type: \"login\",\n          data: utf8_to_b64(config.formData.user)\n        }));\n        config.ws.send(JSON.stringify({\n          type: \"password\",\n          data: utf8_to_b64(config.formData.pwd)\n        }));\n        config.term.reset();\n        setTimeout(() => {\n          resizeRemoteTerminal();\n        }, 500);\n      };\n    };\n    const onCloseSocket = () => {\n      config.ws.onclose = () => {\n        console.log('关闭连接');\n        config.term.write('未连接， 刷新后重连...\\r\\n');\n      };\n    };\n    const onErrorSocket = () => {\n      config.ws.onerror = () => {\n        config.term.write('连接失败，请刷新！');\n      };\n    };\n    const onMessageSocket = () => {\n      config.ws.onmessage = res => {\n        console.log(res);\n        const msg = JSON.parse(res.data);\n        const term = config.term;\n        // console.log(\"receive: \" + data)\n        // 第一次连接成功将 initText 清空\n        if (config.first) {\n          config.first = false;\n          term.reset();\n          term.element && term.focus();\n          resizeRemoteTerminal();\n        }\n        term.write(b64_to_utf8(msg.data));\n      };\n    };\n    const getVmDetail = async () => {\n      try {\n        const rest = await new proxy.$request(proxy.$urls.m().vmdetail + \"?id=\" + config.id).modeget();\n        if (rest.data.code !== 200) {\n          new proxy.$tips(\"获取虚拟机详情失败\", \"warning\").notify();\n        }\n        config.formData.ip = rest.data.data.mgt_ip;\n        config.formData.pwd = rest.data.data.mgt_root_pwd;\n      } catch (e) {\n        console.log(e);\n        if (e.code !== 401) {\n          new proxy.$tips(\"服务器错误，请稍后重试\", \"error\").notify();\n        }\n      }\n    };\n    return {\n      ...toRefs(config),\n      submitForm,\n      resetForm,\n      handleClick,\n      terminal\n    };\n  }\n};","map":{"version":3,"names":["Terminal","FitAddon","debounce","getCurrentInstance","reactive","onBeforeUnmount","onUnmounted","onMounted","toRefs","ref","useRoute","setup","route","terminal","removeResizeListener","config","term","dispose","ws","send","JSON","stringify","type","data","utf8_to_b64","source","query","id","getVmDetail","submitForm","proxy","packResize","cols","rows","validate","rule","value","callback","Error","rules","ip","validator","trigger","port","user","pwd","initText","first","fitAddon","socketUrl","$urls","m","formData","option","lineHeight","cursorBlink","cursorStyle","fontSize","fontFamily","theme","background","foreground","cursor","selection","selectionForeground","initWs","initTerm","initSocket","onTerminalResize","onTerminalKeyPress","activeName","resetForm","formName","resetFields","handleClick","tab","event","name","rawString","btoa","unescape","encodeURIComponent","b64_to_utf8","encodeString","decodeURIComponent","escape","atob","bytesHuman","bytes","precision","test","units","num","Math","floor","log","pow","toFixed","isWsOpen","readyState","loadAddon","open","setTimeout","fit","onData","resizeRemoteTerminal","console","onResize","window","addEventListener","removeEventListener","write","WebSocket","onOpenSocket","onCloseSocket","onErrorSocket","_initialized","onMessageSocket","onopen","reset","onclose","onerror","onmessage","res","msg","parse","element","focus","rest","$request","vmdetail","modeget","code","$tips","notify","mgt_ip","mgt_root_pwd","e"],"sources":["D:\\src\\github.com\\SecurityNeo\\cmdb-ui\\src\\page\\webssh\\webssh.vue"],"sourcesContent":["<template>\r\n  <div>\r\n        <div style=\"text-align: center\" v-if=\"source !== 'plat'\">\r\n          <el-form ref=\"form\" :model=\"formData\" status-icon label-position=\"left\" label-width=\"80px\" style=\"margin-left: 50vh; width: 50vh\">\r\n            <el-form-item label=\"IP地址\" prop=\"ip\">\r\n              <el-input v-model=\"formData.ip\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"端口号\" prop=\"port\">\r\n              <el-input v-model=\"formData.port\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"用户名\" prop=\"user\">\r\n              <el-input v-model=\"formData.user\"/>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码\" prop=\"pwd\">\r\n              <el-input v-model=\"formData.pwd\" type=\"password\" show-password/>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"submitForm()\">连接</el-button>\r\n              <el-button @click=\"resetForm('form')\">重置</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n        <div class=\"ssh-container\" ref=\"terminal\" v-else></div>    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Terminal } from 'xterm'\r\nimport { FitAddon } from 'xterm-addon-fit'\r\nimport 'xterm/css/xterm.css'\r\nimport { debounce } from 'lodash'\r\nimport { getCurrentInstance, reactive,onBeforeUnmount,onUnmounted,onMounted, toRefs,ref  } from 'vue'\r\nimport { useRoute } from 'vue-router';\r\n\r\n\r\n\r\n\r\nexport default {\r\n  setup() {\r\n    const route = useRoute()\r\n    const terminal = ref()\r\n    onBeforeUnmount(()=>{\r\n      removeResizeListener()\r\n      config.term && config.term.dispose()\r\n      config.ws.send(JSON.stringify({\r\n        type: 'stdin',\r\n        data: utf8_to_b64('exit')\r\n      }))\r\n    })\r\n\r\n    onUnmounted(()=>{\r\n      config.ws.send(JSON.stringify({\r\n          type: 'stdin',\r\n          data: utf8_to_b64('exit')\r\n        }))\r\n    }) \r\n\r\n    onMounted(()=>{\r\n      \r\n      config.source = route.query.source\r\n      config.type = route.query.type\r\n      config.id = route.query.id\r\n\r\n      if (config.source === 'plat') {\r\n        if (config.type === 'vm') {\r\n          // 调用虚拟机详情接口查询登录信息\r\n          getVmDetail()\r\n          submitForm()\r\n        } else if ( config.type === 'host') {\r\n          // 调用物理机详情接口查询登录信息\r\n\r\n        }\r\n      }    \r\n    })\r\n    \r\n    const {proxy} = getCurrentInstance()\r\n    \r\n\r\n    const packResize = (cols, rows) =>\r\n      JSON.stringify({\r\n        type: 'resize',\r\n        cols: cols,\r\n        rows: rows\r\n    })\r\n\r\n    const validate = (rule, value, callback) => {\r\n      if (value === '') {\r\n        callback(new Error('不能为空'));\r\n      } else {\r\n        callback();\r\n      }\r\n    }\r\n  \r\n    const config = reactive({\r\n      id: 0,\r\n      source: '',\r\n      type: '',\r\n      rules: {\r\n          ip: [\r\n            {validator: validate, trigger: 'blur'}\r\n          ],\r\n          port: [\r\n            {validator: validate, trigger: 'blur'}\r\n          ],\r\n          user: [\r\n            {validator: validate, trigger: 'blur'}\r\n          ],\r\n          pwd: [\r\n            {validator: validate, trigger: 'blur'}\r\n          ],\r\n        },\r\n      // activeName: 'first',\r\n      initText: '正在努力连接中...\\r\\n',\r\n      first: true,\r\n      term: null,\r\n      fitAddon: null,\r\n      ws: null,\r\n      socketUrl: proxy.$urls.m().ws,\r\n      formData: {\r\n        user: 'root',\r\n        pwd: '',\r\n        ip: '',\r\n        port: '22',\r\n      },\r\n      option: {\r\n        lineHeight: 1.0,\r\n        cursorBlink: true,\r\n        cursorStyle: 'block', // 光标样式 'block' | 'underline' | 'bar'\r\n        fontSize: 15,\r\n        // fontcolor: '#000000',\r\n        fontFamily: \"Monaco, Menlo, Consolas, 'Courier New', monospace\",\r\n        theme: {\r\n          // 背景色\r\n          background: '#ffffff',\r\n          // 前景色\r\n          foreground: '#000000',\r\n          // 光标背景色\r\n          cursor: '#000000',\r\n          // 光标前景色\r\n          /** The accent color of the cursor (fg color for a block cursor) */\r\n          // cursorAccent: '#000000',\r\n          // 选择背景色\r\n          /** The selection background color (can be transparent) */\r\n          selection: '#0000ff',\r\n          // 选择前景色\r\n          /** The selection foreground color */\r\n          selectionForeground: '#0000ff'\r\n        },\r\n        cols: 30 // 初始化的时候不要设置fit，设置col为较小值（最小为可展示initText初始文字即可）方便屏幕缩放\r\n      }\r\n    })\r\n\r\n    const initWs = ()=> {\r\n        initTerm()\r\n        initSocket()\r\n        onTerminalResize()\r\n        onTerminalKeyPress()\r\n    }\r\n\r\n    const submitForm = ()=> {\r\n      config.activeName = 'second'\r\n      initWs()\r\n    }\r\n\r\n    const resetForm = (formName)=> {\r\n        formName.value.resetFields();\r\n    }\r\n\r\n    const handleClick = (tab, event)=> {\r\n        if (tab.name === 'second') {\r\n          // this.init()\r\n        }\r\n    }\r\n\r\n    function utf8_to_b64(rawString) {\r\n        return btoa(unescape(encodeURIComponent(rawString)));\r\n    }\r\n\r\n    function b64_to_utf8(encodeString) {\r\n        return decodeURIComponent(escape(atob(encodeString)));\r\n    }\r\n\r\n    function  bytesHuman(bytes, precision) {\r\n        if (!/^([-+])?|(\\.\\d+)(\\d+(\\.\\d+)?|(\\d+\\.)|Infinity)$/.test(bytes)) {\r\n          return '-'\r\n        }\r\n        if (bytes === 0) return '0';\r\n        if (typeof precision === 'undefined') precision = 1;\r\n        const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB', 'BB'];\r\n        const num = Math.floor(Math.log(bytes) / Math.log(1024));\r\n        const value = (bytes / Math.pow(1024, Math.floor(num))).toFixed(precision);\r\n        return `${value} ${units[num]}`\r\n    }\r\n\r\n    function isWsOpen() {\r\n        return config.ws && config.ws.readyState === 1\r\n    }\r\n    \r\n    const initTerm = ()=> {\r\n        config.term = new Terminal(config.option)\r\n        config.fitAddon = new FitAddon()\r\n        config.term.loadAddon(config.fitAddon)\r\n        config.term.open(terminal.value)\r\n        // config.fitAddon.fit() // 初始化的时候不要使用fit\r\n        setTimeout(() => {\r\n          config.fitAddon.fit()\r\n        }, 500); // 必须延时处理\r\n    }\r\n\r\n    function onTerminalKeyPress() {\r\n        config.term.onData(data => {\r\n          isWsOpen() && config.ws.send(JSON.stringify({\r\n            type: 'stdin',\r\n            data: utf8_to_b64(data)\r\n          }))\r\n        })\r\n    }\r\n\r\n    function resizeRemoteTerminal() {\r\n        const { cols, rows } = config.term\r\n        console.log('列数、行数设置为：', cols, rows)\r\n        // 调整后端终端大小 使后端与前端终端大小一致\r\n        isWsOpen() && config.ws.send(packResize(cols, rows))\r\n      }\r\n    \r\n    const onResize = debounce(function () {\r\n        config.fitAddon.fit()\r\n      }, 500)\r\n  \r\n    function onTerminalResize() {\r\n        window.addEventListener('resize', onResize)\r\n        config.term.onResize(resizeRemoteTerminal)\r\n    }\r\n\r\n    function removeResizeListener() {\r\n        window.removeEventListener('resize', onResize)\r\n    }\r\n\r\n    const initSocket = ()=> {\r\n        config.term.write(config.initText)\r\n        console.log(config.socketUrl)\r\n        config.ws = new WebSocket(config.socketUrl,['webssh'])\r\n        onOpenSocket()\r\n        onCloseSocket()\r\n        onErrorSocket()\r\n        config.term._initialized = true\r\n        onMessageSocket()\r\n    }\r\n\r\n    const onOpenSocket = ()=> {\r\n        config.ws.onopen = () => {\r\n          console.log('websocket 已连接')\r\n          config.ws.send(JSON.stringify({ type: \"addr\", data: utf8_to_b64(config.formData.ip + ':' + config.formData.port) }));\r\n          // socket.send(JSON.stringify({ type: \"term\", data: utf8_to_b64(\"linux\") }));\r\n          config.ws.send(JSON.stringify({ type: \"login\", data: utf8_to_b64(config.formData.user) }));\r\n          config.ws.send(JSON.stringify({ type: \"password\", data: utf8_to_b64(config.formData.pwd) }));\r\n          config.term.reset()\r\n          setTimeout(() => {\r\n            resizeRemoteTerminal()\r\n          }, 500)\r\n        }\r\n    }\r\n\r\n    const onCloseSocket =()=> {\r\n        config.ws.onclose = () => {\r\n          console.log('关闭连接')\r\n          config.term.write('未连接， 刷新后重连...\\r\\n');\r\n        }\r\n    }\r\n    \r\n    const onErrorSocket =()=> {\r\n        config.ws.onerror = () => {\r\n          config.term.write('连接失败，请刷新！')\r\n        }\r\n    }\r\n\r\n    const onMessageSocket = ()=> {\r\n        config.ws.onmessage = res => {\r\n          console.log(res)\r\n          const msg = JSON.parse(res.data)\r\n          const term = config.term\r\n          // console.log(\"receive: \" + data)\r\n          // 第一次连接成功将 initText 清空\r\n          if (config.first) {\r\n            config.first = false\r\n            term.reset()\r\n            term.element && term.focus()\r\n            resizeRemoteTerminal()\r\n          }\r\n          term.write(b64_to_utf8(msg.data))\r\n        }\r\n    }\r\n\r\n\r\n    const getVmDetail = async()=> {\r\n        try {\r\n            const rest = await new proxy.$request(proxy.$urls.m().vmdetail + \"?id=\" + config.id).modeget()\r\n            \r\n            if (rest.data.code !== 200 ) {\r\n                new proxy.$tips(\"获取虚拟机详情失败\", \"warning\").notify()\r\n            }\r\n            config.formData.ip = rest.data.data.mgt_ip\r\n            config.formData.pwd =  rest.data.data.mgt_root_pwd         \r\n        } catch (e) {\r\n            console.log(e);\r\n            if (e.code !== 401) {\r\n                new proxy.$tips(\"服务器错误，请稍后重试\", \"error\").notify()\r\n            }     \r\n        }\r\n    }\r\n\r\n    return {\r\n      ...toRefs(config),\r\n      submitForm,\r\n      resetForm,\r\n      handleClick,\r\n      terminal\r\n    }\r\n\r\n  }\r\n}\r\n\r\n</script>\r\n<style lang=\"scss\">\r\nbody {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n\r\n.ssh-container {\r\n  overflow: hidden;\r\n  height: 85vh;\r\n  border-radius: 4px;\r\n  background: rgb(255, 255, 255);\r\n  padding: 0px;\r\n  //color: rgb(0, 0, 0);\r\n\r\n  .xterm-scroll-area::-webkit-scrollbar-thumb {\r\n    background-color: #b7c4d1;\r\n    /* 滚动条的背景颜色 */\r\n  }\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}