{"ast":null,"code":"import { Box, Management } from '@element-plus/icons-vue';\nimport { onMounted, reactive, ref, toRefs } from 'vue';\nimport { ArrowDown } from '@element-plus/icons-vue';\nexport default {\n  components: {\n    Box,\n    Management,\n    ArrowDown\n  },\n  setup() {\n    const menuArr = [{\n      id: '1',\n      icon: \"Box\",\n      title: \"资源管理\",\n      router: \"\",\n      subClass: [{\n        id: '1-1',\n        title: \"物理机管理\",\n        router: \"server\"\n      }, {\n        id: '1-2',\n        title: \"虚拟机管理\",\n        router: \"vm\"\n      }, {\n        id: '1-3',\n        title: \"网络设备管理\",\n        router: \"networks\"\n      }, {\n        id: '1-4',\n        title: \"资源分组管理\",\n        router: \"tag\"\n      }]\n    }, {\n      id: '2',\n      icon: \"Management\",\n      title: \"系统\",\n      router: \"\",\n      subClass: [{\n        id: '2-1',\n        title: \"用户管理\",\n        router: \"user\"\n      }]\n    }];\n    const config = reactive({\n      userRole: \"\",\n      userName: \"\"\n    });\n\n    // 菜单激活回调函数。将当前激活菜单index存入本地缓存，刷新页面后也可激活前面选中菜单\n    function Select(index) {\n      localStorage.setItem('menuidex', JSON.stringify(index));\n    }\n\n    // 首次进入时值置为“1-1”\n    const ac_index = ref(\"\");\n    onMounted(() => {\n      const menuindex = JSON.parse(localStorage.getItem('menuidex'));\n      if (menuindex == null) {\n        ac_index.value = \"1-1\";\n      } else {\n        ac_index.value = menuindex;\n      }\n      config.userRole = localStorage.getItem(\"role\");\n      config.userName = localStorage.getItem(\"username\");\n    });\n    const logout = () => {\n      localStorage.removeItem('menuidex');\n      localStorage.removeItem('token');\n      localStorage.removeItem('role');\n      localStorage.removeItem('userid');\n      window.location.href = '/';\n    };\n    const menu = reactive(menuArr);\n    return {\n      menu,\n      ac_index,\n      Select,\n      logout,\n      ...toRefs(config),\n      ArrowDown\n    };\n  }\n};","map":{"version":3,"names":["Box","Management","onMounted","reactive","ref","toRefs","ArrowDown","components","setup","menuArr","id","icon","title","router","subClass","config","userRole","userName","Select","index","localStorage","setItem","JSON","stringify","ac_index","menuindex","parse","getItem","value","logout","removeItem","window","location","href","menu"],"sources":["D:\\src\\github.com\\SecurityNeo\\cmdb-ui\\src\\page\\index\\index.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        // 顶部\r\n        <div class=\"sidebar-top\">\r\n            <div>资产管理系统</div>\r\n            <div>\r\n                <el-dropdown>\r\n                    <el-button class=\"userInfo\">\r\n                        <div style=\"text-align: justify;\" v-if=\"userRole === 'admin'\"> 系统管理员 {{ userName }}</div>\r\n                        <div  style=\"text-align: center;\" v-else> 普通用户 {{ userName }}</div>\r\n                        <el-icon class=\"el-icon--right\"><arrow-down /></el-icon>\r\n                    </el-button>\r\n                    <template #dropdown>\r\n                    <el-dropdown-menu>\r\n                        <el-dropdown-item >\r\n                            <div @click=\"logout\">退出</div>\r\n                        </el-dropdown-item>\r\n                    </el-dropdown-menu>\r\n                    </template>\r\n                </el-dropdown>\r\n            </div>\r\n\r\n        </div>\r\n        // 侧边栏菜单\r\n        <div class=\"sidebar-cont\">\r\n            <el-menu :default-active=\"ac_index\" @select=\"Select\">\r\n                    <div v-for=\"(item,index) in menu\" :key=\"index\">\r\n                        <router-link :to=\"{path:item.router}\">\r\n                            <el-menu-item v-if=\"item.subClass.length == 0\" :index=\"item.id\"> \r\n                                <el-icon>\r\n                                    <component :is=\"item.icon\"></component>\r\n                                </el-icon>\r\n                                <span>{{ item.title }}</span>\r\n                            </el-menu-item>\r\n                        </router-link>\r\n                        <el-sub-menu v-if=\"item.subClass.length > 0\" :index=\"item.id\">\r\n                            <template #title>\r\n                                <el-icon>\r\n                                    <component :is=\"item.icon\"></component>\r\n                                </el-icon>\r\n                                <span>{{ item.title }}</span>\r\n                            </template>\r\n                            <div v-for=\"(v,k) in item.subClass\" :key=\"k\">\r\n                                <router-link :to=\"{path: v.router}\">\r\n                                    <el-menu-item :index=\"v.id\">{{ v.title }}</el-menu-item>\r\n                                </router-link>\r\n                            </div>\r\n                        </el-sub-menu>\r\n                    </div>\r\n            </el-menu>\r\n        </div>\r\n        <router-view></router-view>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {Box, Management} from '@element-plus/icons-vue'\r\nimport { onMounted, reactive, ref, toRefs } from 'vue'\r\nimport { ArrowDown } from '@element-plus/icons-vue'\r\n\r\n\r\nexport default{\r\n    components: {\r\n        Box,\r\n        Management,\r\n        ArrowDown\r\n    },\r\n    setup() {\r\n        const menuArr = [\r\n            {\r\n                id: '1',\r\n                icon: \"Box\",\r\n                title: \"资源管理\",\r\n                router: \"\",\r\n                subClass: [\r\n                    {\r\n                        id: '1-1',\r\n                        title: \"物理机管理\",\r\n                        router: \"server\"\r\n                    },\r\n                    {\r\n                        id: '1-2',\r\n                        title: \"虚拟机管理\",\r\n                        router: \"vm\"\r\n                    },\r\n                    {\r\n                        id: '1-3',\r\n                        title: \"网络设备管理\",\r\n                        router: \"networks\"\r\n                    },\r\n                    {\r\n                        id: '1-4',\r\n                        title: \"资源分组管理\",\r\n                        router: \"tag\"\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                id: '2',\r\n                icon: \"Management\",\r\n                title: \"系统\",\r\n                router: \"\",\r\n                subClass: [\r\n                    {\r\n                        id: '2-1',\r\n                        title: \"用户管理\",\r\n                        router: \"user\"\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n        \r\n        const config = reactive({\r\n            userRole: \"\",\r\n            userName: \"\"\r\n        })\r\n\r\n        // 菜单激活回调函数。将当前激活菜单index存入本地缓存，刷新页面后也可激活前面选中菜单\r\n        function Select(index) {\r\n            localStorage.setItem('menuidex',JSON.stringify(index))     \r\n        }\r\n\r\n        // 首次进入时值置为“1-1”\r\n        const ac_index = ref(\"\")\r\n        onMounted(()=>{\r\n            const menuindex = JSON.parse(localStorage.getItem('menuidex'))\r\n            if (menuindex == null) {\r\n                ac_index.value = \"1-1\"\r\n            } else {\r\n                ac_index.value = menuindex\r\n            }\r\n            \r\n            config.userRole = localStorage.getItem(\"role\")\r\n            config.userName = localStorage.getItem(\"username\")\r\n            \r\n        })\r\n\r\n        const logout = () => {\r\n            localStorage.removeItem('menuidex')\r\n            localStorage.removeItem('token')\r\n            localStorage.removeItem('role')\r\n            localStorage.removeItem('userid')\r\n            window.location.href = '/'\r\n        }\r\n\r\n        const menu = reactive(menuArr)\r\n        return {\r\n            menu, \r\n            ac_index, \r\n            Select,\r\n            logout,\r\n            ...toRefs(config),\r\n            ArrowDown\r\n        }\r\n    }\r\n}\r\n</script>"],"mappings":"AAwDA,SAAQA,GAAG,EAAEC,UAAU,QAAO,yBAAwB;AACtD,SAASC,SAAS,EAAEC,QAAQ,EAAEC,GAAG,EAAEC,MAAK,QAAS,KAAI;AACrD,SAASC,SAAQ,QAAS,yBAAwB;AAGlD,eAAc;EACVC,UAAU,EAAE;IACRP,GAAG;IACHC,UAAU;IACVK;EACJ,CAAC;EACDE,KAAKA,CAAA,EAAG;IACJ,MAAMC,OAAM,GAAI,CACZ;MACIC,EAAE,EAAE,GAAG;MACPC,IAAI,EAAE,KAAK;MACXC,KAAK,EAAE,MAAM;MACbC,MAAM,EAAE,EAAE;MACVC,QAAQ,EAAE,CACN;QACIJ,EAAE,EAAE,KAAK;QACTE,KAAK,EAAE,OAAO;QACdC,MAAM,EAAE;MACZ,CAAC,EACD;QACIH,EAAE,EAAE,KAAK;QACTE,KAAK,EAAE,OAAO;QACdC,MAAM,EAAE;MACZ,CAAC,EACD;QACIH,EAAE,EAAE,KAAK;QACTE,KAAK,EAAE,QAAQ;QACfC,MAAM,EAAE;MACZ,CAAC,EACD;QACIH,EAAE,EAAE,KAAK;QACTE,KAAK,EAAE,QAAQ;QACfC,MAAM,EAAE;MACZ;IAER,CAAC,EACD;MACIH,EAAE,EAAE,GAAG;MACPC,IAAI,EAAE,YAAY;MAClBC,KAAK,EAAE,IAAI;MACXC,MAAM,EAAE,EAAE;MACVC,QAAQ,EAAE,CACN;QACIJ,EAAE,EAAE,KAAK;QACTE,KAAK,EAAE,MAAM;QACbC,MAAM,EAAE;MACZ;IAER,EACJ;IAEA,MAAME,MAAK,GAAIZ,QAAQ,CAAC;MACpBa,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACd,CAAC;;IAED;IACA,SAASC,MAAMA,CAACC,KAAK,EAAE;MACnBC,YAAY,CAACC,OAAO,CAAC,UAAU,EAACC,IAAI,CAACC,SAAS,CAACJ,KAAK,CAAC;IACzD;;IAEA;IACA,MAAMK,QAAO,GAAIpB,GAAG,CAAC,EAAE;IACvBF,SAAS,CAAC,MAAI;MACV,MAAMuB,SAAQ,GAAIH,IAAI,CAACI,KAAK,CAACN,YAAY,CAACO,OAAO,CAAC,UAAU,CAAC;MAC7D,IAAIF,SAAQ,IAAK,IAAI,EAAE;QACnBD,QAAQ,CAACI,KAAI,GAAI,KAAI;MACzB,OAAO;QACHJ,QAAQ,CAACI,KAAI,GAAIH,SAAQ;MAC7B;MAEAV,MAAM,CAACC,QAAO,GAAII,YAAY,CAACO,OAAO,CAAC,MAAM;MAC7CZ,MAAM,CAACE,QAAO,GAAIG,YAAY,CAACO,OAAO,CAAC,UAAU;IAErD,CAAC;IAED,MAAME,MAAK,GAAIA,CAAA,KAAM;MACjBT,YAAY,CAACU,UAAU,CAAC,UAAU;MAClCV,YAAY,CAACU,UAAU,CAAC,OAAO;MAC/BV,YAAY,CAACU,UAAU,CAAC,MAAM;MAC9BV,YAAY,CAACU,UAAU,CAAC,QAAQ;MAChCC,MAAM,CAACC,QAAQ,CAACC,IAAG,GAAI,GAAE;IAC7B;IAEA,MAAMC,IAAG,GAAI/B,QAAQ,CAACM,OAAO;IAC7B,OAAO;MACHyB,IAAI;MACJV,QAAQ;MACRN,MAAM;MACNW,MAAM;MACN,GAAGxB,MAAM,CAACU,MAAM,CAAC;MACjBT;IACJ;EACJ;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}