{"ast":null,"code":"import { reactive, getCurrentInstance, ref } from 'vue';\nexport default {\n  setup() {\n    const tag = reactive({\n      name: \"\",\n      description: \"\"\n    });\n    const addTagRef = ref();\n    const rules = {\n      name: [{\n        required: true,\n        message: '标签不能为空',\n        trigger: 'blur'\n      }]\n    };\n    const config = reactive({\n      centerDialogVisible: false,\n      isLoading: false\n    });\n    const {\n      proxy\n    } = getCurrentInstance();\n    const addTag = async addTagRef => {\n      await addTagRef.validate((valid, fileds) => {\n        if (valid) {\n          config.isLoading = true;\n          new proxy.$request(proxy.$urls.m().tagAdd, tag).modepost().then(rest => {\n            if (rest.data.code !== 200) {\n              new proxy.$tips(\"创建标签失败，稍后重试\", \"error\").notify();\n            }\n            config.isLoading = false;\n            config.centerDialogVisible = false;\n            proxy.$emit('flushPage');\n          });\n        }\n      });\n      config.isLoading = true;\n      const rest = await new proxy.$request(proxy.$urls.m().tagAdd, tag).modepost();\n      if (rest.data.code !== 200) {\n        new proxy.$tips(\"创建标签失败，稍后重试\", \"error\").notify();\n      }\n      config.isLoading = false;\n      config.centerDialogVisible = false;\n      proxy.$emit('flushPage');\n    };\n    const addTagDialog = () => {\n      config.centerDialogVisible = true;\n    };\n    return {\n      tag,\n      config,\n      addTag,\n      addTagDialog,\n      addTagRef,\n      rules\n    };\n  }\n};","map":{"version":3,"names":["reactive","getCurrentInstance","ref","setup","tag","name","description","addTagRef","rules","required","message","trigger","config","centerDialogVisible","isLoading","proxy","addTag","validate","valid","fileds","$request","$urls","m","tagAdd","modepost","then","rest","data","code","$tips","notify","$emit","addTagDialog"],"sources":["D:\\src\\github.com\\SecurityNeo\\cmdb-ui\\src\\page\\resource\\tag\\components\\addtag-dialog.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <el-dialog\r\n            v-model=config.centerDialogVisible\r\n            title=\"新建标签\"\r\n            width=\"30%\"\r\n            align-center\r\n            :close-on-click-modal=\"false\"            \r\n        >\r\n        <div>\r\n            <el-form\r\n                    ref=\"addTagRef\"\r\n                    :model=\"tag\"\r\n                    :rules=\"rules\"\r\n                    label-width=\"120px\"\r\n                    status-icon\r\n                >\r\n                \r\n                <div style=\"width: 400px; margin-left: 20px;\">\r\n                    <el-form-item label=\"名称\" prop=\"name\">\r\n                        <el-input v-model=\"tag.name\" clearable  style=\"width: 300px;\"  placeholder=\"请输入标签名称\"  />\r\n                    </el-form-item>\r\n\r\n                    <el-form-item label=\"描述\" prop=\"description\">\r\n                        <el-input v-model=\"tag.description\" clearable type=\"textarea\" class=\"inputflex\"  placeholder=\"请输入描述信息\"  />\r\n                    </el-form-item>\r\n                </div>\r\n            </el-form>\r\n\r\n        \r\n            <div style=\"float: right; margin-bottom: 40px; margin-right: 72px;margin-top: 20px;\">\r\n                <el-button @click=\"config.centerDialogVisible = false\">取消</el-button>\r\n                <el-button type=\"primary\" :loading=\"config.isLoading\" @click=\"addTag(addTagRef)\" >确认</el-button>\r\n            </div>\r\n                      \r\n\r\n        </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {reactive, getCurrentInstance, ref} from 'vue'\r\n\r\nexport default {\r\n    setup() {\r\n        const tag = reactive({\r\n            name: \"\",\r\n            description: \"\"\r\n        })\r\n\r\n        const addTagRef = ref()\r\n        const rules = {\r\n            name: [\r\n                { required: true, message: '标签不能为空', trigger: 'blur' }\r\n            ]\r\n        }\r\n\r\n        const config = reactive({\r\n            centerDialogVisible: false,\r\n            isLoading: false\r\n        })\r\n\r\n        const {proxy} = getCurrentInstance()\r\n        const addTag = async(addTagRef) => {\r\n\r\n            await addTagRef.validate((valid,fileds)=>{\r\n                if(valid) {\r\n                    config.isLoading = true\r\n                    new proxy.$request(proxy.$urls.m().tagAdd, tag).modepost()\r\n                    .then(rest=>{\r\n                        if (rest.data.code !== 200) {\r\n                            new proxy.$tips(\"创建标签失败，稍后重试\", \"error\").notify()\r\n                        }\r\n                        config.isLoading = false\r\n                        config.centerDialogVisible = false\r\n                        proxy.$emit('flushPage')\r\n                    })\r\n                }\r\n            })\r\n\r\n            config.isLoading = true\r\n            const rest = await new proxy.$request(proxy.$urls.m().tagAdd, tag).modepost()\r\n            if (rest.data.code !== 200) {\r\n                new proxy.$tips(\"创建标签失败，稍后重试\", \"error\").notify()\r\n            }\r\n            config.isLoading = false\r\n            config.centerDialogVisible = false\r\n            proxy.$emit('flushPage')\r\n        }\r\n\r\n        const addTagDialog = ()=> {\r\n            config.centerDialogVisible = true\r\n        }\r\n\r\n        return {tag, config, addTag, addTagDialog,addTagRef,rules}\r\n    }\r\n}\r\n</script>"],"mappings":"AA0CA,SAAQA,QAAQ,EAAEC,kBAAkB,EAAEC,GAAG,QAAO,KAAI;AAEpD,eAAe;EACXC,KAAKA,CAAA,EAAG;IACJ,MAAMC,GAAE,GAAIJ,QAAQ,CAAC;MACjBK,IAAI,EAAE,EAAE;MACRC,WAAW,EAAE;IACjB,CAAC;IAED,MAAMC,SAAQ,GAAIL,GAAG,CAAC;IACtB,MAAMM,KAAI,GAAI;MACVH,IAAI,EAAE,CACF;QAAEI,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,QAAQ;QAAEC,OAAO,EAAE;MAAO;IAE7D;IAEA,MAAMC,MAAK,GAAIZ,QAAQ,CAAC;MACpBa,mBAAmB,EAAE,KAAK;MAC1BC,SAAS,EAAE;IACf,CAAC;IAED,MAAM;MAACC;IAAK,IAAId,kBAAkB,CAAC;IACnC,MAAMe,MAAK,GAAI,MAAMT,SAAS,IAAK;MAE/B,MAAMA,SAAS,CAACU,QAAQ,CAAC,CAACC,KAAK,EAACC,MAAM,KAAG;QACrC,IAAGD,KAAK,EAAE;UACNN,MAAM,CAACE,SAAQ,GAAI,IAAG;UACtB,IAAIC,KAAK,CAACK,QAAQ,CAACL,KAAK,CAACM,KAAK,CAACC,CAAC,CAAC,CAAC,CAACC,MAAM,EAAEnB,GAAG,CAAC,CAACoB,QAAQ,CAAC,EACxDC,IAAI,CAACC,IAAI,IAAE;YACR,IAAIA,IAAI,CAACC,IAAI,CAACC,IAAG,KAAM,GAAG,EAAE;cACxB,IAAIb,KAAK,CAACc,KAAK,CAAC,aAAa,EAAE,OAAO,CAAC,CAACC,MAAM,CAAC;YACnD;YACAlB,MAAM,CAACE,SAAQ,GAAI,KAAI;YACvBF,MAAM,CAACC,mBAAkB,GAAI,KAAI;YACjCE,KAAK,CAACgB,KAAK,CAAC,WAAW;UAC3B,CAAC;QACL;MACJ,CAAC;MAEDnB,MAAM,CAACE,SAAQ,GAAI,IAAG;MACtB,MAAMY,IAAG,GAAI,MAAM,IAAIX,KAAK,CAACK,QAAQ,CAACL,KAAK,CAACM,KAAK,CAACC,CAAC,CAAC,CAAC,CAACC,MAAM,EAAEnB,GAAG,CAAC,CAACoB,QAAQ,CAAC;MAC5E,IAAIE,IAAI,CAACC,IAAI,CAACC,IAAG,KAAM,GAAG,EAAE;QACxB,IAAIb,KAAK,CAACc,KAAK,CAAC,aAAa,EAAE,OAAO,CAAC,CAACC,MAAM,CAAC;MACnD;MACAlB,MAAM,CAACE,SAAQ,GAAI,KAAI;MACvBF,MAAM,CAACC,mBAAkB,GAAI,KAAI;MACjCE,KAAK,CAACgB,KAAK,CAAC,WAAW;IAC3B;IAEA,MAAMC,YAAW,GAAIA,CAAA,KAAK;MACtBpB,MAAM,CAACC,mBAAkB,GAAI,IAAG;IACpC;IAEA,OAAO;MAACT,GAAG;MAAEQ,MAAM;MAAEI,MAAM;MAAEgB,YAAY;MAACzB,SAAS;MAACC;IAAK;EAC7D;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}